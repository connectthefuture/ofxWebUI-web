field_templates["text-field-template"]=function(b){var a=' <div data-role="fieldcontain"> <label for="'+(b.name)+'">'+(b.title)+':</label> <input class="'+(b.options.template)+'-field" type="'+(b.options.type)+'" name="'+(b.name)+'" id="'+(b.name)+'" ';if("default_value" in b.options){a+='value="'+(b.options.default_value)+'"'}a+=" /> </div> ";return a};field_templates["slider-field-template"]=function(b){var a=' <div data-role="fieldcontain"> <label for="'+(b.name)+'">'+(b.title)+':</label> <input class="'+(b.options.template)+'-field" type="range" name="'+(b.name)+'" id="'+(b.name)+'" step="'+(b.options.step)+'" ';if("default_value" in b.options){a+='value="'+(b.options.default_value)+'"'}a+=' min="'+(b.options.min)+'" max="'+(b.options.max)+'" /> </div> ';return a};field_templates["radio-field-template"]=function(e){var d=' <div data-role="fieldcontain"> <fieldset data-role="controlgroup" id="'+(e.name)+'"> <legend>'+(e.title)+"</legend> ";var c=e.options.choices;if(c){var a=-1,b=c.length-1;while(a<b){choice=c[a+=1];d+=' <input class="'+(e.options.template)+'-field" type="radio" name="'+(e.name)+"_"+(a)+'" id="'+(e.name)+"_"+(a)+'" value="'+(a)+'" /> <label for="'+(e.name)+"_"+(a)+'">'+(choice)+"</label> "}}d+=" </fieldset> </div> ";return d};field_templates["imagelist-field-template"]=function(e){var d=' <div data-role="fieldcontain"> <fieldset data-role="controlgroup" id="'+(e.name)+'"> <legend>'+(e.title)+'</legend> <ul data-role="listview"> ';var c=e.options.choices;if(c){var a=-1,b=c.length-1;while(a<b){item=c[a+=1];d+=' <li class="'+(e.options.template)+'-field"> <a href="#"> <img src="'+(item.image)+'" /> <h3>'+(item.title)+"</h3> <p>"+(item.title)+"</p> </a> </li> "}}d+=" </ul> </fieldset> </div> ";return d};field_templates["toggle-field-template"]=function(b){var a=' <div data-role="fieldcontain"> <label for="'+(b.name)+'">'+(b.title)+'</label> <select class="'+(b.options.template)+'-field" data-role="slider" name="'+(b.name)+'" id="'+(b.name)+'" > <option value="0">Off</option> <option value="1">On</option> </select> </div> ';return a};field_templates["color-field-template"]=function(b){var a=' <div data-role="fieldcontain"> <label for="'+(b.name)+'">'+(b.title)+'</label> <input class="'+(b.options.template)+'-field" type="text" name="'+(b.name)+'" id="'+(b.name)+'" ';if("default_value" in b.options){a+='value="'+(b.options.default_value)+'"'}else{a+=' value="#000000" '}a+=' /> <div class="colorpicker"></div> </div> ';return a};group_templates["list-group-template"]=function(b){var a=' <ul data-role="listview" class="'+(b.options.template)+'-group" > <li> <h1>'+(b.title)+"</h1> "+(b.content)+" </li> </ul> ";return a};group_templates["page-group-template"]=function(b){var a=' <div data-role="page" id="'+(b.name)+'" class="'+(b.options.template)+'-group" > <div data-role="header"> <h1>'+(b.title)+'</h1> </div> <div data-role="content"> '+(b.content)+' </div> <div data-role="footer"> </div> </div> ';return a};group_templates["collapsible-group-template"]=function(b){var a=' <div data-role="collapsible" class="'+(b.options.template)+'-group" > <h3>'+(b.title)+"</h3> "+(b.content)+" </div> ";return a};function get_value_from_field(c,b,a){var d=undefined;switch(b){case"color":d=parseInt(c.val().replace("#","0x"));break;case"radio":var d=-1;jQuery('input[type="radio"]',c).each(function(e,f){var g=(c.attr("id")===a);c.attr("checked",g).checkboxradio("refresh");if(g){d=e}});d=d;break;case"toggle":d=(jQuery("select",c)[0].selectedIndex>0);break;case"text":case"slider":d=c.val();break;case"imagelist":d=c.index();break;default:d=c.value;break}return d}function set_field_from_value(d,e,f,c){switch(c){case"color":var a="#"+f.toString(16);jQuery.farbtastic(d.next(".colorpicker")).setColor(a);break;case"toggle":d[0].selectedIndex=f?1:0;d.slider("refresh");break;case"radio":var g=jQuery('input[type="radio"]',d);g.attr("checked",false);var b=[e,f].join("_");jQuery('input[type="radio"]#'+b).attr("checked",true);g.checkboxradio("refresh");break;case"slider":d.val(f).slider("refresh");break;case"text":d.val(f);break;case"imagelist":console.log("implement me");break;default:d.value=f;break}}function get_appropriate_ws_url(b){var e;var d=document.URL;if(d.substring(0,5)=="https"){e="wss://";d=d.substr(8)}else{e="ws://";if(d.substring(0,4)=="http"){d=d.substr(7)}}d=d.split("/");var c;if(b!==undefined){var a=d[0].split(":");c=a[0]+":"+b}else{c=d[0]}return e+c}jQuery(document).bind("mobileinit",function(){var c=jQuery("#form");var d=new protobuf.ui;var e=function(i,k){if(k==="."){k=""}var f=[];for(var h in i.properties_){var j=i.properties_[h].type();switch(j){default:var p=i.properties_[h].options||{},g=p.template+"-group-template";if(g in group_templates){var m={title:h,name:k+h,options:p,content:e(j,k+h+".")},o=group_templates[g](m);f.push(o)}break;case PROTO.string:case PROTO.uint32:case PROTO.sfixed32:case PROTO.fixed32:case PROTO.int32:case PROTO.sint32:case PROTO.uint32:case PROTO.uint64:case PROTO.sfixed64:case PROTO.fixed64:case PROTO.int64:case PROTO.sint64:case PROTO.uint64:case PROTO.Float:case PROTO.Double:case PROTO.bool:case PROTO.string:var p=i.properties_[h].options||{},l={title:h,name:k+h,options:p},g=p.template+"-field-template";if(g in field_templates){var n=field_templates[g](l);f.push(n)}break}}return f.join("")};var b=e(d,"");jQuery(b).appendTo(c);var a=function(s){if(!live||!ws){return}var p=new protobuf.ui,j=(ws.binaryType==="arraybuffer")?new PROTO.ByteArrayStream:new PROTO.Base64Stream,m=jQuery(s.target),o=m.closest("div[data-role='fieldcontain']"),q=jQuery("input",o),l=(q.length&&q||m.closest("li.imagelist-field")),h=(l.attr("name")&&l.attr("name").split(".")||o&&jQuery("fieldset",o)[0].id.split(".")),t=templateFromClassRegex.exec(l.attr("class"));if(t.length>1){var r=t[1],g=p,f=h.length;for(var k=0;k<(f-1);k++){g=g[h[k]]}g[h[f-1]]=get_value_from_field(l,r,s.target.id);p.SerializeToStream(j);ws.send(j.getString())}};jQuery("div[data-role='fieldcontain']",c).on("change",a);jQuery("div[data-role='fieldcontain'] li",c).on("click",a);jQuery(".colorpicker").each(function(){jQuery(this).farbtastic({callback:jQuery(this).prev("input"),width:200})})});jQuery(document).ready(function(){var d=jQuery("#ws_url");var e=" | ";var c="G++ Sign";var b=function(){try{if(ws.readyState!==ws.CLOSING&&ws.readyState!==ws.CLOSED){ws.close(0)}}catch(f){console.log("Error"+f)}};var a=function(){var g=get_appropriate_ws_url(7681);try{if(window.MozWebSocket){ws=new MozWebSocket(g,"ofx")}else{if(window.WebSocket){ws=new WebSocket(g,"ofx")}else{return}}ws.onopen=function(){d.attr("data-theme","d").click(b);jQuery(".ui-icon",d).addClass("ui-icon-check").removeClass("ui-icon-refresh");jQuery(".ui-btn-text",d).text(g);jQuery("#ws_status").text("Connected");document.title=c+e+"Connected"};ws.onmessage=function(m){var k=new protobuf.ui;var l=(ws.binaryType==="arraybuffer")?new PROTO.ByteArrayStream(m.data):new PROTO.Base64Stream(m.data);k.ParseFromStream(l);live=false;for(var j in k.values_){var i=jQuery("#"+j);var h=k.properties_[j].options;if(i){set_field_from_value(i,k.values_[j],h.template)}}live=true};ws.onclose=function(){d.attr("data-theme","b").click(a);jQuery(".ui-icon",d).addClass("ui-icon-refresh").removeClass("ui-icon-check");jQuery(".ui-btn-text",d).text("Reconnect");jQuery("#ws_status").text("Disconnected");document.title=c+e+"Disconnected"}}catch(f){console.log("Error"+f)}};a();d.click(a)});